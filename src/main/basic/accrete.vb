10	CLS
20	SCREEN 2
30	RANDOMIZE
40	DIM STO(500), SWP (25,5), V$(25), HLD(25,5),U$(25)
50	INPUT "max e",E: INPUT "stellar mass",MS: INPUT "dust",D:INPUT "gas",G
60	IF E=0 THEN E=.4
70	IF MS=0 THEN MS=1
80	IF D=0 THEN D=1
90	G=G*25: IF G=0 THEN G=25
100 G = G/D
110	FOR I = 1 TO 500
120	R=(I/10)/(MS^.33)
130	U=R^.33)
140	STO(I)=D*1.5*R*R*EXP(-5!*U)
150	NEXT!
160 SM=STO(500)
170	IN=3*SQR(LS):IN=INT(IN): IF IN <.5 THEN IN = 1
180 IF STO(IN) < SM THEN SM=STO(IN)
190 SM = SM/2
200	LS= MS:4:IF MS < .4 THEN LS = .23'(MS:2.31
210	N
220 REM
230	REM start iteration
240 REM
250 GOSUB 2500
260	SWP(N,3)=E'RND:SWP(N,01-0:V$1N1- "r"
270	SWP(N,5)--0
280	IF SWP (N,3) > 1 THEN SWP(N,3)= 1
310	FOR KK - 1TO N-1
320	PRINT KK,SWP(KK,2),SWPIKK,51 .03
330	NEXT KK
360	K= N
370	GOSUB 2300
380	GOSUB 2000
390	IF N = 26THEN GOTO 410
400	GOTO 250
410	GOSUB 2900
420	GOSUB 1000
430	PRINT "max e ",E,"stellar mass ",MS:PRINT "dust ", D, "gas ",G* D125
440	PRINT " " :PRINT "#","orbit","mass","e","type"
450	FOR 1=1TO N
460	PRINTI,SWP(1,2),SWP(1,5) .03,SWP(1,31,V$(1)
470	NEXTI
480	GOSUB 1000
490	GOSUB 4000
500	INPUT "picture", PIC
510	GOSUB 2690
520	INPUT "winddown". PIC
530	SCREEN 0: WIDTH 80: STOP
1000	REM
1010	REM next screen
1020	INPUT "next screen",PIC:CLS:RETURN
2000	REM
2010	REM collisions and aftermath
2020	IF N > 1.5 THEN RETURN
2030	FOR K = 1TO N-1
2040	IF SWP(N,4) < SWP(K,1) THEN GOTO 2210
2050	IF SWP(K,4) < SWP(N,1) THEN GOTO 2210
2060	PRINT "COLLISION" K "AND" N
2070	H =SWP (N,5) * SOR(SWP(N,2)"(1-SWP1N,3)*
	SWP(N.3)))
2080	H=H+SWPIK,51*SGRISWP(K,2)*(1-SWP(K,31'
	SWP(K,3)))
2090	SWP(K,51= SWPIN,5) + SWP(K,5): H = H. SWP(K,5)
2100	SWP(K,0)- SWPIN,O) + SWP(K,O)
2110	KF=SWP(N,31:1F KF > SWPIK,3)THEN KF=SWP(K,3):
	SWPIK,31- RND*KF
2120	SWPIK,21- H*Hi(1-SWP(K,3)*SWP(K,3))
2130	GOSUB 2300
2140	N - N-1
2150	IF K= N THEN GOTO 2020
2160	FOR L=0 TO 5:SWP(N+1,L)=SWPIK.LI:NEXTL:V$
	(N+1)=VS(K)
2170	FOR L-0 TO 5:SWP(K,L)=SWP(N,L):NEXTL:V$IKI=
	MN)
2180	FOR L=0 TO 5.:SWP(N,LI-SWP(N+1,L):NEXT
	L:VS(N)=V$(N+1)
2190	FOR L=0 TO 5:SWP(N+1,L)=0:NEXTL:V$
	(N+1)---
2200	GOTO 2020
2210	NEXT K
2220	RETURN
2300	REM
2310	REM accretion
2320	RA= SWP(K,2)*11 + SWPIK,3)):RP -SWP(K.2)
	"(1-SWP(K,3))
2330	MC= .12*(RP'-.75)* (LS:.375)
2340	SWPIK,5)--SWP(K,0):IF SWP(K,O) > MC
	THEN SWP (K,5) = MC +G*ISWP(K,0)-MCI
2350	KF=.1*1(SWP(K,51V1S)-.25)
2360	SWP(K,11- RP-KF:SWP1K,4). RA+ KF
2370	IM=INT(10*SWP(K,1)4-.5):IX	1NT(10*SWP
	(K,41+.5)
2380	!FM< INTHENIM=IN
2390	IF IX > 500 THEN IX -- 500
2400	DM = 0
2410	FOR 1=1M TO IX:DM := DM +STOW:STOW- 0:
	NEXTI
2420	SWP1K,O)	SWP(K,O) + DM
2430	IF DM > SM:2 THEN GOTO 2340
2440	IF SWP(K,01> MC THEN VS(K)= "g"
2450	SWP(K,5)--- SWP(K,0): IF SWP(K,0) > MC THEN SWP(K,5) = MC +G"(SWP(K,0)-MC)
2460	IF SWP(K,5) >200 THEN V$IK)- " * "
2470	RETURN
2480	REM
2490	REM position of next nucleus
2500	SUM -0
2510	PRINT" "
2520	FOR I =IN TO 500
2530	SUM SUM +ST011)
2540	REM X-70+90*LOG(1-.5):Y=70+90*LOG(1+.5)
2550	REM IF STO(I)>0 THEN LINE (X,100)-(Y.100)
2560	NEXT!
2570	PRINT SUM:.03 "LEFT"
2580	IF SUM < SMTHEN GOTO 410
2590	SUM=SUM*RND
2600	FOR I =1N TO 500
2610	SUM = SUM-STO(1)
2620	R=1,10
2630	IF SUM < 0 THEN GOTO 2650
2640	NEXTI
2650	N= N + 1
2660	SWP(N,2)=R
2670	RETURN
2680	REM
2690	REM picture
2700	CLS
2710	SCREEN 1
2720	SCL=300:LOG(50..3):KK-10-SCL*LOG(.3)
2730	LINE (10,100)-(310,100)
2740	FOR I = 1 TO N
2750	IF SWP(1,2) < .3 THEN GOTO 2860
2760	X = KK+SCL* LOG(SWP(1,21)
2770	RA- SWP(1,21' (1 + SWP(1,3)):RP- SWP(1,2)" (1-SWP(1,3))
2780	Y=KK +SU' LOG(RP):Z = KK +SCL*LOGIRA)
2790	IF SWP(I,5) < SM THEN GOTO 2860
2800	R=10*(SWP(1,5),(1'3))
2810	LINE ('1,140 +I)-(Z,140+1):COL = 1
2820	M0---.12*(RP:-.751'ILS,.375)
2830	IF SWP(I,5) > MC THEN COL - 2
2840	IF SWP(I,5) > 200 THEN COL-3
2850	CIRCLE (X,100),R,COL
2860	NEXT I
2870	RETURN
2880	REM
2890	REM sorting
2900	FOR1= 1 TON: M- 0 R=55:
2910	FOR J-1 TO N: IF SWP(J,2)>R THEN GOTO
	2950
2920	IF SWP(J,51< SMI2 THEN GOTO 2940
2930	R=SWP1J,21:M=J:GOT0 2950
2940	N = N-1
2950	NEXT J
2960	FOR L = 0 TO 5
2970	HLDII,L1-5WPIM,LI:NEXT L
2980	U$(1)=VS(M)
2990	SWP(M,2)= 60:NEXT I
3000	FOR I = 1TO N
3010	V$(1)= US(!)
3020	FOR L = 0 TO 4
3030	SWP(11)=.001"INT(1000' HLD(1,L))
3040	NEXT L
3050	SWP(1,5)k- .00003' INT(1000..03" HLD(I,5))
3060	U$(1)="?" :IF V$(1)---: >"r" THEN U$(1):- "NO"
3070	IF SWP(I,5) < 911000 THEN U$(1)= "no"
3080	NEXT I
3090	RETURN
4000	REM
4010	REM secondary quantities
4020	PRINT "#","YEAR","temp c","incl."
4030	FOR 1=1 TO N
4040	YR =SCIR(SWP11,2)/MS1'SWP(1,2):YR =.001'
	INT(1000*YR)
4050	T=2138*(LS-.25)SQR(SWP (1,2)1-273:T=INT(T)
4060	IN= 180*(1-(RND-(2,$))):IN	.1"INT(10" IN)
4070	IF T < -14 THEN US(11= "no"
4080	IF T > 65 THEN U$111- "no"
4090	PRINT I,YR,T,IN
4100	NEXTI
4110	GOSUB 1010
4120	REM
4130	PRINT "#","radius(km)","g(m.s'2)","size"
4140	FOR I= 1 TO N
4150	IF V$11)<>"r" THEN GOTO 4250:REM
	terrestrials
4160	R =(SWP(1,5) .03)-(1.2):MM- R*(2-(1 3))
4170	RN= MM*2( -R '3)
4180	IF ABS(R-RN)< .01 THEN GOTO 4200
4190	R=RN:GOTO 4170
4200	SWP(1,1)=RN:R=INT(6400*RN):S=
	INT(5.672*RN)
4210	IF S>7 THEN S=7
4220	G=327*SWP(1,5),IRN"RN):G= .001"INT
	(1000*G)
4230	S=S+INT(8' RN)/1000
4240	PRINT I,R,G,S:GOTO 4320
4250	IF V$(1)<>"g" THEN GOT04300:REM gas giants
4260	S = 8:IF SWP(1,51> 1 THEN S=9
4270	IF SWP(1,51 > 10 THEN S=10
4280	RN- 4.2952 * (SWP(1,51:3846):IF RN < 10.5
	THEN RN =10.5
4290	SWP(I,1)= RN :R -INT(6400*RN):GOTO 4220
4330	REM stars
4310	RN = .6946" (SWP(1,5):5936{:S	11: GOTO 4290
4320	NEXTI
4330	REM
4340	GOSUB 1010
4350	PRINT" # ","sun tide","day > (hrs)","suitable"
4360	FOR I =1 TO N
4370	H= .020214*MS'(SWP11,1).411SWP(1,5)*
	(SWP(1,2).3))+1 -H*H
4380	H= .001*INT(1000*H)
4390	IF H > 2 AND U$(1) - "7" THEN U$W	'77"
4400	IF H > 400 THEN U$11)	"no"
4410	DY=2.667*SWP(1,1) SCIR(SWP(1,51)
4420	DY - .001 * INT(1000` DV)
4430	PRINTI,H,DY,U$(1)
4440	NEXTI
4450	RETURN
